# 主数据建模II

主要包括动态建模和主数据编码。可以把建模完成的物料模型发布到动态的主数据节点或者导出Excel模板，并可以发起新增或修改物料主数据时的审批流程。

## 动态建模

点击【主数据建模II】→【动态建模】，进入动态建模界面，如下图所示。

![](/articles/cloudmdm/3-/images/image24.png)

<p align="center">图：动态建模</p>
 
* 新增大类

单击左侧主数据分类树的根节点“主数据分类”，单击〖新增〗增加大类，填写内容（*表示必填项）后，单击〖保存〗。

![](/articles/cloudmdm/3-/images/image25.png)

<p align="center">图：新增大类</p>


大类包括通用属性和扩展属性。

**扩展属性**：新增的时候可以删除（点击减号），保存之后不可以删除。

* 新增小类

单击左侧主数据分类树的大类，单击〖新增〗增加小类，填写内容（*表示必填项）后，单击〖保存〗。

![](/articles/cloudmdm/3-/images/image26.png)

<p align="center">图：新增小类</p>

新增的小类自动继承大类的通用属性。在新增修改小类时必须参照选择大类的扩展属性。

“类型”：字段的类型。

“长度”：字段的长度。

“必输项”：勾选以后表示必须输入。

“查询条件”：是否可查询。勾选后，将在主数据节点左侧显示查询框。

“是否唯一”：唯一性判断。

“参照对象”：该字段可参照的其他物料。只有两个类型（参照和下拉）需要配置参照对象。

“显示字段”：下拉或参照类型的字段，参照某个物料主数据，在这里配置维护时显示哪个字段。

“默认值”：如选中，表示维护字段的时候默认有值。


* 修改和删除大类

单击左侧主数据分类树的大类，单击〖修改〗和〖删除〗进行相应操作。如果该分类下存在已发布的节点，则不能删除该分类。

![](/articles/cloudmdm/3-/images/image27.png)

<p align="center">图：修改删除大类</p> 

* 修改和删除小类

单击左侧主数据分类树的小类，单击〖修改〗和〖删除〗进行相应操作。如果该分类下存在已发布的节点，则不能删除该分类。

![](/articles/cloudmdm/3-/images/image28.png)

<p align="center">图：修改删除小类</p>


* 发布小类

单击左侧主数据分类树的小类，单击〖发布〗按钮进行发布。发布的小类也可以单击〖反发布〗按钮取消发布。

![](/articles/cloudmdm/3-/images/image29.png)

<p align="center">图：发布小类</p> 

* 导出Excel

单击定义树的某个小类，单击〖导出excel模板〗，生成Excel文件（文件名为实体的编码）,包含该小类所包含的实体属性，保存到本地。

![](/articles/cloudmdm/3-/images/image30.png)

<p align="center">图：导出Excel</p> 

* 新增或修改物料主数据时的审批流程

本审批流程仅适用于物料的主数据。

有物料主数据权限的用户都可以发起审批流程。

如果没有权限，系统管理员登录，在【管理中心】→【角色管理】中有内置的“主数据管理类角色”，在【角色分配用户】节点将这个角色分配给相关人员。

设置审批的具体流程如下：

（1）	点击【主数据建模II】→【动态建模】，选择物料大类，单击〖新增〗，勾选〖流程特性〗，如下图所示：

![](/articles/cloudmdm/3-/images/image31.png)
 
<p align="center">图：新增物料小类</p>

（2）	选择该物料小类，单击〖发布〗，发布物料主数据模型。

（3）	配置流程模型（由系统管理员进行配置）。

a.	点击【管理中心】→【流程模型】，如下图：

![](/articles/cloudmdm/3-/images/image32.png)

<p align="center">图：配置流程模型</p>

 

b.	单击〖新建分组〗，然后在该分组下单击〖新增〗，新增流程模型。“模型”参照选择刚才发布的物料小类。

![](/articles/cloudmdm/3-/images/image33.png)

<p align="center">图：新增流程模型</p>



c.	对新建的流程进行设计。鼠标放置到流程行，显示〖设计〗按钮并点击，进入流程设计界面。

![](/articles/cloudmdm/3-/images/image34.png)

<p align="center">图：进入设计界面</p>
 
![](/articles/cloudmdm/3-/images/image35.png)

<p align="center">图：流程设计</p>

绿色圆点为流程起点，红色圆点为流程终点。将左上角〖审批任务〗拉入界面，新增一个审批任务。然后点击箭头进行连接。

![](/articles/cloudmdm/3-/images/image36.png)

<p align="center">图：新增审批任务</p>
 

点击流程中的〖审批任务〗设置审批用户，在右侧属性栏选择用户，单击〖确定〗。

![](/articles/cloudmdm/3-/images/image37.png)

<p align="center">图：设置审批用户</p>


流程设置完成，单击左上角〖保存模型〗。

d.	单击〖发布〗，发布流程模型。

![](/articles/cloudmdm/3-/images/image38.png)

<p align="center">图：发布流程模型</p>


（4）	发布流程模型之后，有物料主数据权限的用户就可以发起“新增或修改物料主数据”的审批流程。审批人员在【应用中心】→【流程管理】→【任务中心】，查看待办任务，点击任务进行审批。

如果不同意，审批人可以选择退到“制单人”或“上层审批人”。

![](/articles/cloudmdm/3-/images/image39.png)

<p align="center">图：审批</p>



（5）	在【主数据】的物料主数据节点，点击〖审批任务〗查看审批进度，点击〖审批历史〗查看已经审批通过的数据的审批历史。


## 主数据编码

点击【主数据建模II】→【主数据编码】，进入主数据编码界面。在该页面里，左边是实体和物料的分类树，以便实体和物料的选择，右边是该主数据编码的管理。

![](/articles/cloudmdm/3-/images/image40.png)

<p align="center">图：主数据编码</p> 

主数据编码由以下三种元素类型组成：

1)	常量：即固定值，表示固定字符串和分隔符，长度取字符串长度；

2)	时间：主数据产生的具体时间；

3)	流水号：主数据的顺序号。

* 查看编码规则

单击分类树的某个分类下的某个实体，在页面右边会显示该实体的编码信息，包括：规则编码，规则名称，时间格式，编码长度，编码展示效果，以及编码规则的各元素的组成等。如果该实体未定义编码规则，则各显示项无内容。


* 修改编码

单击左侧主数据，单击〖修改编码〗按钮，完成编辑后按〖确定〗。

![](/articles/cloudmdm/3-/images/image41.png)

<p align="center">图：修改编码</p> 

* 删除编码

单击左侧主数据，单击〖删除〗按钮，按〖确定〗进行删除。

![](/articles/cloudmdm/3-/images/image42.png)

<p align="center">图：删除编码</p>